module.exports=[63250,a=>{"use strict";a.s(["getProfileStatusLabel",()=>g,"getUserRoleLabel",()=>h,"isAdmin",()=>f,"isApproved",()=>d,"isPending",()=>e]);let b={approved:"승인됨",pending:"승인 대기",rejected:"거절됨",blocked:"차단됨"},c={member:"회원",admin:"관리자"};function d(a){return"approved"===a}function e(a){return"pending"===a}function f(a){return"admin"===a}function g(a){return b[a]??"미정"}function h(a){return c[a]??"회원"}},58903,a=>{"use strict";a.s(["Separator",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Separator() from the server but Separator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/separator.tsx <module evaluation>","Separator")},19665,a=>{"use strict";a.s(["Separator",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Separator() from the server but Separator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/separator.tsx","Separator")},20407,a=>{"use strict";a.i(58903);var b=a.i(19665);a.n(b)},55747,a=>{"use strict";a.s(["formatDate",()=>c]);var b=a.i(14617);function c(a,d=b.DEFAULT_LANGUAGE){if(!a)return"";let e=a instanceof Date?a:new Date(a);return Number.isNaN(e.getTime())?"":new Intl.DateTimeFormat(d,{year:"numeric",month:"short",day:"numeric"}).format(e)}},93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},62212,a=>{a.n(a.i(66114))},43710,a=>{a.n(a.i(13954))},22605,a=>{"use strict";a.s(["Input",()=>d]);var b=a.i(7997),c=a.i(82248);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}},16025,a=>{"use strict";a.s(["updateUserRoleAction",()=>j,"updateUserStatusAction",()=>i]);var b=a.i(37936),c=a.i(18558),d=a.i(53058),e=a.i(98310),f=a.i(13095);let g=new Set(["pending","approved","rejected","blocked"]),h=new Set(["member","admin"]);async function i(a){await (0,d.requireRole)("admin");let b=a.get("userId"),f=a.get("status");if("string"!=typeof b||!("string"==typeof f&&g.has(f)))return void console.error("회원 상태 변경 실패 - 잘못된 입력",{userId:b,status:f});let h=await (0,e.createSupabaseServerClient)(),i={status:f,approved_at:"approved"===f?new Date().toISOString():null},{error:j}=await h.from("profiles").update(i).eq("id",b);if(j)return void console.error("회원 상태 변경 실패",j);(0,c.revalidatePath)("/admin/users")}async function j(a){await (0,d.requireRole)("admin");let b=a.get("userId"),f=a.get("role");if("string"!=typeof b||!("string"==typeof f&&h.has(f)))return void console.error("회원 역할 변경 실패 - 잘못된 입력",{userId:b,role:f});let g=await (0,e.createSupabaseServerClient)(),{error:i}=await g.from("profiles").update({role:f}).eq("id",b);if(i)return void console.error("회원 역할 변경 실패",i);(0,c.revalidatePath)("/admin/users")}(0,f.ensureServerEntryExports)([i,j]),(0,b.registerServerReference)(i,"40a6ddfcdd11f727e42365af7ec5ff30f1e2584986",null),(0,b.registerServerReference)(j,"40fe0ad3bb8010fd0d58702cb81e5fb7100678dae9",null)},81259,a=>{"use strict";a.s(["40a6ddfcdd11f727e42365af7ec5ff30f1e2584986",()=>c.updateUserStatusAction,"40fe0ad3bb8010fd0d58702cb81e5fb7100678dae9",()=>c.updateUserRoleAction],81259),a.s([],79186);var b=a.i(16025);a.i(79186);var c=b},70362,a=>{"use strict";a.s(["default",()=>p],70362);var b=a.i(7997),c=a.i(97647),d=a.i(22605),e=a.i(43917),f=a.i(20407),g=a.i(55747),h=a.i(63250),i=a.i(16025);let j=[{label:"승인",value:"approved",variant:"default"},{label:"대기",value:"pending",variant:"outline"},{label:"거절",value:"rejected",variant:"outline"},{label:"차단",value:"blocked",variant:"destructive"}],k=[{label:"회원으로 전환",value:"member"},{label:"관리자로 지정",value:"admin"}];function l({users:a}){return a.length?(0,b.jsx)("div",{className:"overflow-hidden rounded-xl border border-border/60",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-border/60 text-sm",children:[(0,b.jsx)("thead",{className:"bg-muted/40",children:(0,b.jsxs)("tr",{className:"text-left text-xs uppercase tracking-wider text-muted-foreground",children:[(0,b.jsx)("th",{className:"px-4 py-3",children:"이름"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"연락처"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"상태"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"역할"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"가입 사유"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"가입일"}),(0,b.jsx)("th",{className:"px-4 py-3",children:"액션"})]})}),(0,b.jsx)("tbody",{className:"bg-white",children:a.map(a=>(0,b.jsxs)("tr",{className:"pending"===a.status?"bg-amber-50/60":void 0,children:[(0,b.jsxs)("td",{className:"px-4 py-3 align-top",children:[(0,b.jsx)("div",{className:"font-medium text-slate-900",children:a.fullName||"이름 없음"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.email??"이메일 미확인"})]}),(0,b.jsx)("td",{className:"px-4 py-3 align-top text-xs text-muted-foreground",children:a.phone??"-"}),(0,b.jsx)("td",{className:"px-4 py-3 align-top text-xs",children:(0,b.jsx)("span",{className:"rounded-full border border-border/60 px-2 py-1 text-xs font-medium",children:(0,h.getProfileStatusLabel)(a.status)})}),(0,b.jsx)("td",{className:"px-4 py-3 align-top text-xs",children:(0,b.jsx)("span",{className:"rounded-full border border-border/60 px-2 py-1 text-xs font-medium",children:(0,h.getUserRoleLabel)(a.role)})}),(0,b.jsx)("td",{className:"px-4 py-3 align-top text-xs text-muted-foreground",children:(0,b.jsx)("p",{className:"line-clamp-3 whitespace-pre-wrap",children:a.joinReason??"-"})}),(0,b.jsxs)("td",{className:"px-4 py-3 align-top text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{children:["가입: ",(0,g.formatDate)(a.createdAt)]}),a.approvedAt&&(0,b.jsxs)("div",{children:["승인: ",(0,g.formatDate)(a.approvedAt)]})]}),(0,b.jsx)("td",{className:"px-4 py-3 align-top",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[j.map(c=>(0,b.jsxs)("form",{action:i.updateUserStatusAction,children:[(0,b.jsx)("input",{type:"hidden",name:"userId",value:a.id}),(0,b.jsx)("input",{type:"hidden",name:"status",value:c.value}),(0,b.jsx)("button",{type:"submit",className:`rounded-full px-3 py-1 text-xs font-medium shadow-sm transition-colors ${function(a){switch(a){case"default":return"bg-primary text-primary-foreground hover:bg-primary/90";case"outline":return"border border-border/60 bg-white text-muted-foreground hover:border-primary hover:text-primary";case"destructive":return"bg-destructive text-destructive-foreground hover:bg-destructive/90";default:return""}}(c.variant)}`,children:c.label})]},c.value)),(0,b.jsx)("div",{className:"h-px w-full bg-border/60"}),k.map(c=>(0,b.jsxs)("form",{action:i.updateUserRoleAction,children:[(0,b.jsx)("input",{type:"hidden",name:"userId",value:a.id}),(0,b.jsx)("input",{type:"hidden",name:"role",value:c.value}),(0,b.jsx)("button",{type:"submit",className:"rounded-full border border-border/60 px-3 py-1 text-xs font-medium text-muted-foreground transition-colors hover:border-primary hover:text-primary",children:c.label})]},c.value))]})})]},a.id))})]})}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"조건에 맞는 사용자가 없습니다."})}var m=a.i(98310);async function n(a){let b=(await (0,m.createSupabaseServerClient)()).from("profiles").select(`
        id,
        full_name,
        phone,
        join_reason,
        status,
        role,
        created_at,
        approved_at,
        auth_user:auth.users (
          email
        )
      `).order("created_at",{ascending:!1});if(a.status&&(b=b.eq("status",a.status)),a.search){let c=`%${a.search}%`;b=b.or(`full_name.ilike.${c},join_reason.ilike.${c}`)}let{data:c,error:d}=await b;return d?(console.error("관리자 사용자 목록 조회 실패",d),[]):c?.map(a=>({id:a.id,email:a.auth_user?.email??null,fullName:a.full_name,phone:a.phone,joinReason:a.join_reason,status:a.status,role:a.role,createdAt:a.created_at,approvedAt:a.approved_at}))??[]}let o=[{label:"전체",value:"all"},{label:"대기",value:"pending"},{label:"승인",value:"approved"},{label:"거절",value:"rejected"},{label:"차단",value:"blocked"}];async function p({searchParams:a}){let c=a.q?.trim()??"",d=o.some(b=>b.value===a.status)?a.status:"all",e=await n({search:c,status:"all"===d?null:d}),g=e.filter(a=>"pending"===a.status).length,h=e.filter(a=>"admin"===a.role).length;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"회원 관리"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"가입 승인, 역할 변경, 차단 처리를 할 수 있습니다."})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsx)(q,{title:"총 조회",value:`${e.length}명`,description:"검색 조건에 해당하는 회원"}),(0,b.jsx)(q,{title:"승인 대기",value:`${g}명`,description:"빠른 승인 처리가 필요합니다."}),(0,b.jsx)(q,{title:"관리자",value:`${h}명`,description:"현재 관리자 수"})]}),(0,b.jsx)(f.Separator,{}),(0,b.jsx)(r,{search:c,status:d}),(0,b.jsx)(l,{users:e})]})}function q({title:a,value:c,description:d}){return(0,b.jsxs)("div",{className:"rounded-xl border border-border/60 bg-white p-4 shadow-sm",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a}),(0,b.jsx)("p",{className:"text-2xl font-semibold text-slate-900",children:c}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:d})]})}function r({search:a,status:f}){return(0,b.jsxs)("form",{className:"flex flex-col gap-3 rounded-xl border border-border/60 bg-muted/20 p-4 md:flex-row md:items-center md:justify-between",action:"/admin/users",children:[(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,b.jsx)(d.Input,{name:"q",placeholder:"이름 또는 가입 이유 검색",defaultValue:a,className:"md:max-w-sm"}),(0,b.jsx)("select",{name:"status",defaultValue:f,className:"h-10 rounded-md border border-input bg-background px-2 text-sm text-foreground shadow-sm focus:outline-none focus:ring-2 focus:ring-ring",children:o.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{type:"submit",variant:"default",children:"필터 적용"}),(0,b.jsx)(e.Button,{asChild:!0,variant:"outline",children:(0,b.jsx)(c.default,{href:"/admin/users",children:"초기화"})})]})]})}},16407,a=>{a.v(a=>Promise.resolve().then(()=>a(89431)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ef22cdeb._.js.map