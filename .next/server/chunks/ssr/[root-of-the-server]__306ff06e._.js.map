{"version":3,"sources":["turbopack:///[project]/lib/monitoring/logger.ts","turbopack:///[project]/components/ui/separator.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/components/ui/alert.tsx","turbopack:///[project]/lib/validators/devotion.ts","turbopack:///[project]/.next-internal/server/app/(public)/devotion/write/page/actions.js (server actions loader)","turbopack:///[project]/app/(public)/devotion/write/actions.ts","turbopack:///[project]/components/forms/devotion-form.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/app/(public)/devotion/write/page.tsx"],"sourcesContent":["type LogLevel = 'info' | 'warn' | 'error';\n\ntype LogContext = Record<string, unknown>;\n\nconst ENVIRONMENT = process.env.NODE_ENV ?? 'development';\n\nfunction sanitizeMeta(meta?: LogContext) {\n  if (!meta) {\n    return undefined;\n  }\n\n  return JSON.parse(\n    JSON.stringify(meta, (_key, value) => {\n      if (value instanceof Error) {\n        return {\n          name: value.name,\n          message: value.message,\n          stack: value.stack,\n        };\n      }\n      return value;\n    }),\n  );\n}\n\nfunction writeLog(level: LogLevel, message: string, meta?: LogContext) {\n  const payload = {\n    level,\n    message,\n    meta: sanitizeMeta(meta),\n    timestamp: new Date().toISOString(),\n    environment: ENVIRONMENT,\n  };\n\n  const serialized = JSON.stringify(payload);\n\n  switch (level) {\n    case 'error':\n      console.error(serialized);\n      break;\n    case 'warn':\n      console.warn(serialized);\n      break;\n    default:\n      console.info(serialized);\n  }\n}\n\nexport function logInfo(message: string, meta?: LogContext) {\n  writeLog('info', message, meta);\n}\n\nexport function logWarn(message: string, meta?: LogContext) {\n  writeLog('warn', message, meta);\n}\n\nexport function logError(message: string, meta?: LogContext) {\n  writeLog('error', message, meta);\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const Separator = registerClientReference(\n    function() { throw new Error(\"Attempted to call Separator() from the server but Separator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/separator.tsx\",\n    \"Separator\",\n);\n","import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n","import { z } from 'zod';\n\nexport const devotionCreateSchema = z.object({\n  title: z.string().min(3, '제목은 최소 3자 이상 입력해주세요.'),\n  scriptureRef: z.string().min(2, '성경 구절을 입력해주세요.'),\n  scriptureText: z.string().min(5, '구절 내용을 입력해주세요.'),\n  body: z.string().min(50, '묵상 내용은 최소 50자 이상 작성해주세요.'),\n  imageUrl: z.string().url('올바른 이미지 주소가 아닙니다.').optional().or(z.literal('').transform(() => undefined)),\n});\n\nexport type DevotionCreateValues = z.infer<typeof devotionCreateSchema>;\n\nexport const devotionUpdateSchema = devotionCreateSchema.extend({\n  id: z.string().uuid(),\n});\n\nexport type DevotionUpdateValues = z.infer<typeof devotionUpdateSchema>;\n","export {signOutAction as '006e87d2ba50d7749061e0234a2c5ee819ab969621'} from 'ACTIONS_MODULE0'\nexport {createDevotionAction as '407b6c36bdb832e57f6ea5151eb54c21a807c9b76e'} from 'ACTIONS_MODULE1'\n","'use server';\n\nimport { redirect } from 'next/navigation';\n\nimport { requireApprovedStatus } from '@/lib/auth/session';\nimport { createSupabaseServerClient } from '@/lib/supabase/server';\nimport { sanitizeHTML } from '@/lib/sanitize';\nimport { devotionCreateSchema, type DevotionCreateValues } from '@/lib/validators/devotion';\nimport { logError } from '@/lib/monitoring/logger';\n\ntype DevotionActionError = {\n  status: 'error';\n  message: string;\n  fieldErrors?: Partial<Record<keyof DevotionCreateValues, string[]>>;\n};\n\nexport async function createDevotionAction(values: DevotionCreateValues): Promise<DevotionActionError | void> {\n  const profile = await requireApprovedStatus(['approved']);\n\n  const parsed = devotionCreateSchema.safeParse(values);\n\n  if (!parsed.success) {\n    return {\n      status: 'error',\n      message: '입력값을 확인해주세요.',\n      fieldErrors: parsed.error.flatten().fieldErrors,\n    };\n  }\n\n  const supabase = await createSupabaseServerClient();\n\n  const sanitizedBody = sanitizeHTML(parsed.data.body);\n  const sanitizedScriptureText = sanitizeHTML(parsed.data.scriptureText);\n\n  const { data, error } = await supabase\n    .from('devotions')\n    .insert({\n      author_id: profile.id,\n      title: parsed.data.title.trim(),\n      scripture_ref: parsed.data.scriptureRef.trim(),\n      scripture_text: sanitizedScriptureText,\n      body: sanitizedBody,\n      image_url: parsed.data.imageUrl ? parsed.data.imageUrl.trim() : null,\n    })\n    .select('id')\n    .single();\n\n  if (error || !data) {\n    logError('묵상 작성 실패', { error, profileId: profile.id });\n    return {\n      status: 'error',\n      message: '묵상 작성 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.',\n    };\n  }\n\n  redirect(`/devotion/${data.id}`);\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DevotionForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call DevotionForm() from the server but DevotionForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/forms/devotion-form.tsx\",\n    \"DevotionForm\",\n);\n","import type { Metadata } from 'next';\nimport Link from 'next/link';\n\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Separator } from '@/components/ui/separator';\nimport { DevotionForm } from '@/components/forms/devotion-form';\nimport { requireApprovedStatus } from '@/lib/auth/session';\n\nexport const metadata: Metadata = {\n  title: '묵상 작성 | 위루다 선교 공동체',\n  description: '승인된 회원만 묵상을 작성할 수 있습니다.',\n};\n\nexport default async function DevotionWritePage() {\n  await requireApprovedStatus(['approved']);\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h1 className=\"text-2xl font-semibold text-slate-900\">묵상 작성</h1>\n        <p className=\"text-sm text-muted-foreground\">오늘 나눈 말씀과 기도 제목을 함께 공유해주세요.</p>\n      </div>\n      <Alert>\n        <AlertTitle>안내</AlertTitle>\n        <AlertDescription>\n          본 서비스는 한국어 원문을 기준으로 제공됩니다. 다른 언어 사용자는 브라우저 자동 번역 기능을 이용해 묵상을\n          확인하게 되니, 예의와 배려를 담아 정직하게 작성해주세요.\n        </AlertDescription>\n      </Alert>\n      <DevotionForm />\n      <Separator />\n      <p className=\"text-center text-sm text-muted-foreground\">\n        목록으로 돌아가기:{' '}\n        <Link href=\"/devotion\" className=\"text-primary underline-offset-4 hover:underline\">\n          묵상 목록\n        </Link>\n      </p>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[1,6]}